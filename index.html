<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Welder RM Tool</title>

<style>
body{
  margin:0;
  font-family:Inter,Arial,sans-serif;
  background:#0b0f14;
  color:#e5e7eb;
  display:flex;
  justify-content:center;
  padding:16px 0;
}
.container{
  width:100%;
  max-width:420px;
  padding:0 12px;
}
h1{text-align:center;margin-bottom:14px;}
.card{
  background:#111827;
  border-radius:16px;
  padding:16px;
  box-shadow:0 0 30px rgba(0,0,0,.6);
}

/* SIDE */
.side{display:flex;gap:8px;}
.side button{
  flex:1;padding:10px;border:none;border-radius:10px;
  color:#fff;font-weight:600;cursor:pointer;
}
.long{background:#10b981;}
.short{background:#ef4444;}
.active{box-shadow:0 0 14px rgba(255,255,255,.35);}

/* INPUTS */
label{font-size:12px;margin-top:10px;display:block;color:#9ca3af;}
input,select{
  width:100%;margin-top:4px;padding:8px;
  border-radius:8px;border:none;
  background:#1f2937;color:#fff;
}

/* TP */
.tpBlock{
  margin-top:10px;padding:10px;
  border-radius:10px;
  background:#020617;border:1px solid #1e293b;
}
.tpHeader{font-weight:600;margin-bottom:6px;}
.addTp{margin-top:10px;color:#38bdf8;cursor:pointer;font-size:13px;}

/* BUTTON */
.calc{
  width:100%;margin-top:16px;padding:12px;
  border-radius:12px;border:none;
  background:linear-gradient(90deg,#0ea5e9,#f97316);
  color:#020617;font-weight:700;cursor:pointer;
}

/* RESULT */
.result{
  display:none;margin-top:14px;padding:12px;
  border-radius:12px;background:#0f172a;border:1px solid #1e293b;
}
.sideText{text-align:center;font-weight:800;font-size:18px;}
.row{margin-top:4px;}
.tpRes{
  margin-top:8px;padding:8px;
  border-radius:8px;background:#020617;
}
.real{
  margin:10px 0;padding:10px;border-radius:10px;
  background:linear-gradient(135deg,#0ea5e9,#f97316);
  color:#020617;font-weight:700;text-align:center;
}
</style>
</head>

<body>
<div class="container">
<h1>Welder RM Tool</h1>

<div class="card">

<div class="side">
  <button id="longBtn" class="long active">LONG</button>
  <button id="shortBtn" class="short">SHORT</button>
</div>

<label>Депозит ($)</label>
<input id="deposit" type="number" value="1000">

<label>Риск (%)</label>
<input id="risk" type="number" value="0.8">

<label>Сумма в сделку ($)</label>
<input id="trade" type="number" value="500">

<label>Плечо (x)</label>
<input id="lev" type="number" value="1">

<label>Цена входа</label>
<input id="entry" type="number" value="100">

<label>Risk / Reward (RR)</label>
<input id="rr" type="number" value="3">

<div id="tpContainer"></div>
<div class="addTp" onclick="addTP()">+ Добавить TP</div>

<button class="calc" onclick="calc()">Рассчитать</button>
<div id="result" class="result"></div>

</div>
</div>

<script>
let side='long', tpCount=0;

longBtn.onclick=()=>{side='long';longBtn.classList.add('active');shortBtn.classList.remove('active');}
shortBtn.onclick=()=>{side='short';shortBtn.classList.add('active');longBtn.classList.remove('active');}

function addTP(){
  if(tpCount>=4) return;
  tpCount++;
  tpContainer.insertAdjacentHTML('beforeend',`
    <div class="tpBlock">
      <div class="tpHeader">TP${tpCount}</div>
      <select id="tp${tpCount}Type">
        <option value="percent">% от входа</option>
        <option value="price">Цена</option>
      </select>
      <input id="tp${tpCount}Val" type="number" placeholder="Введите значение">
    </div>
  `);
}

function calc(){
  const dep=+deposit.value;
  const riskP=+risk.value;
  const trade=+trade.value;
  const lev=+lev.value||1;
  const entry=+entry.value;
  const rr=+rr.value||1;

  if(!dep||!trade||!entry) return;

  const riskUsd = dep * (riskP/100);
  const realVol = trade / lev;
  const slPercent = (riskUsd / realVol / entry) * 100;

  const slPrice = side==='long'
    ? entry * (1 - slPercent/100)
    : entry * (1 + slPercent/100);

  const rrTpPrice = side==='long'
    ? entry + (entry - slPrice) * rr
    : entry - (slPrice - entry) * rr;

  let html = `
    <div class="sideText">${side.toUpperCase()}</div>
    <div class="row">Risk: $${riskUsd.toFixed(2)} (${riskP}%)</div>
    <div class="real">Фактическая сумма: $${realVol.toFixed(2)}</div>
    <div class="row">Стоп-лосс: ${slPercent.toFixed(2)}%</div>
    <div class="row">Цена SL: ${slPrice.toFixed(2)}</div>
    <div class="row">RR: 1:${rr}</div>
    <div class="row">Цена TP (RR): ${rrTpPrice.toFixed(2)}</div>
  `;

  for(let i=1;i<=tpCount;i++){
    const type=document.getElementById(`tp${i}Type`).value;
    const val=+document.getElementById(`tp${i}Val`).value;
    if(!val) continue;

    const tpPrice = type==='percent'
      ? (side==='long'? entry*(1+val/100):entry*(1-val/100))
      : val;

    const profit = side==='long'
      ? (tpPrice-entry)*realVol
      : (entry-tpPrice)*realVol;

    html+=`
      <div class="tpRes">
        TP${i}: ${tpPrice.toFixed(2)}<br>
        Прибыль: $${profit.toFixed(2)}
      </div>`;
  }

  result.style.display='block';
  result.innerHTML=html;
}
</script>

</body>
</html>
